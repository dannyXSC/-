import json

IPC_info = [
    {"index": "1.1",
     "name": "煤炭清洁高效利用",
     "no": ["E02D17/20", "E02D19/06", "E21C41/16", "E21F15/00",
            "E21C41/18", "E21C41/28", "E21C47/02", "B01D21/01",
            "C02F1/48", "C02F1/52", "C02F9/12", "C02F103/10",
            "E21B21/01", "E21F5/00", "E21F7/00", "E21B43/295",
            "E21C41/16", "E21B43/24", "E21F15/00", "E21B21/08",
            "E21B44/00", "E21F17/18", "B03", "B07B",
            "B07C5/00", "B03B13/00", "B07B13/04", "F24D3/18",
            "F24D12/02", "F24H4/00", "F25B30/06", "E21B43/12",
            "E21B43/16", "E21B43/25", "E21C25/00", "E21C27/00",
            "E21C29/00", "E21C31/00", "E21C35/00", "E21C39/00",
            "E21F1/00", "E21F13/00", "E21F17/00", "E99",
            "F01D15/10", "F01K23/02", "F02C6/00", "F01K7/32",
            "F22B3/08", "F22B35/12", "F01K25/10",
            "F01K9/00", "F01K13/00", "F01K17/00", "F01K19/00",
            "F02G5/02", "F25B27/02",
            "H02J3/38",
            "F23K1/00",
            "C10J3/00", "C10L9/00", "C10L10/00",
            "F02B45/02", "F23D14/26", "F23D14/32", "F23D14/58",
            "F23D14/66", "F23D23/00", "F23L7/00", "F23L15/00",
            "F23R3/28", "F24V30/00", "F27B1/26", "F27B1/28",
            "F27B3/28", "F27B5/18", "F27B7/42", "F27B9/40",
            "F27B13/14", "F27B14/20", "F27D19/00", "F27D21/00",
            "F23B10/00", "F23B70/00", "F23C6/00", "F23K3/00",
            "F23N", "F23R",
            "C10B53/04",
            "C10B21/00", "C10B39/00", "C10B41/00", "C10B47/00",
            "C10B49/00", "C10B55/00", "C10B57/00",
            "B01D53/48", "B01D53/60", "B01D53/62", "F23J15/02",
            "C21C5/38",
            "C21B13/08", "C22B1/216", "C22B15/06", "F23C9/00",
            "F23C99/00", "F25B27/02", "F25B29/00",
            "C10L1/00",
            "C07C2/06", "C07C2/40", "C07C2/44", "C07C2/54",
            "C07C2/74", "C07C11/02", "C07C11/12", "C07C11/21",
            "C07C15/00", "C07C25/00", "C07C31/04", "C10G45/00",
            "C10G47/00", "C10G49/00", "C10G65/00", "C10G67/00",
            "C10G69/00",
            "C07C",
            "C10B", "C10L3/00", "C10J3/00",
            ]
     },
    {"index": "1.2",
     "name": "石油及天然气清洁化",
     "no": [
         "E21B43/12", "E21B43/24", "E21B43/25", "E21B43/34",
         "E21F15/00",
         "E21B43/16",
         "E21B43/22",
         "E21F7/00",
         "E21F17/18",
         "E21",
         "C07C7/163",
         "C10G1/06", "C10G45/00", "C10G47/00", "C10G65/00",
         "C10G67/00", "C10G69/00",
         "C01B3/00",
         "C10G11/05", "C10G11/14",
         "C07C7/04", "C07C11/02", "F25J3/02",
         "C10",
         "E21B43/12", "E21B43/14", "E21B43/16", "E21B43/25",
         "E21B43/34", "E21F7/00", "E21F17/18",
         "E21",
         "C01B3/32", "C07C2/00", "C07C7/00", "C07C11/02",
         "C07C11/24", "C07C29/151",
         "C07C31/04",
         "C10L3/06",
     ]
     },
    {"index": "2.1",
     "name": "节油技术",
     "no": [
         "F02D17/00",
         "F02B43/02",
         "F02C9/32", "F02C9/36", "F02C9/38",
         "F02D43/00",
         "F02M33/02",
         "F02D41/00",
     ]},
    {"index": "2.2",
     "name": "节气技术",
     "no": [
         "F02B69/04", "F02C3/22", "F02C3/28", "F02M21/00",
         "F23D14/02", "F23D14/20", "F23D14/28", "F23D14/32",
         "F23D14/34", "F23D14/60", "F23Q2/16", "F23Q7/10",
         "F23R3/00", "F24C3/00",
         "F02B1/00", "F02B11/00", "F02B13/02", "F02B13/06",
         "F02B3/00", "F02B7/00", "F02B9/00", "F02B23/10",
         "F02B51/00", "F02B57/02", "F02D19/00", "F02D21/00",
         "F02M13/08", "F23D14/22", "F23D17/00", "F23G5/12",
         "F23N5/18", "F23Q1/04",
         "F23D14/66"
     ]},
    {"index": "2.3",
     "name": "节电技术",
     "no": [
         "F21K9/00", "F21Y115/00",
         "F15B9/03", "F15B9/17", "F16D27/00", "F16D28/00",
         "H04W52/02",
         "G01R31/00", "G05B19/02", "G06Q50/06", "H02J3/00",
         "H02J13/00",
         "H02B", "H02J", "H02M",
         "H02J1/00", "H02J7/35",
     ]},
    {"index": "2.4",
     "name": "能量回收利用",
     "no": [
         "B60L7/10", "B60T1/10", "D21F5/20", "F01K17/02",
         "F01K17/06", "F01K27/02", "F02C7/10", "F02G5",
         "F15B21/14", "F16D61", "F17C9/04", "F22B1/16",
         "F22B1/18", "F22D1/40", "F22G1/02", "F22G1/12",
         "F22G5/06", "F23G5/46", "F24F3/147", "F24F12",
         "F27D17", "F24H8/00", "F28C1/08",
     ]},
    {"index": "3.1",
     "name": "水能",
     "no": [
         "H02K",
         "F03B1/00", "F03B3/00", "F03B13/06", "F03B13/08",
         "F03B13/10", "F03B15/20", "H02P101/10",
         "E02B9/00(NOT:E02B9/08)",
         "F03B7/00", "F03B17/02(NOT:F03B17/04)", "F03B17/06",
     ]},
    {"index": "3.2",
     "name": "太阳能",
     "no": [
         "H02K",
         "F03B1/00", "F03B3/00", "F03B13/06", "F03B13/08",
         "F03B13/10", "F03B15/20", "H02P101/10",
         "E02B9/00(NOT:E02B9/08)",
         "F03B7/00", "F03B17/02(NOT:F03B17/04)", "F03B17/06",
         "F02C1/05", "F24C9/00", "F24D101/40", "F24J2/00",
         "F24S",
         "H01G9/20", "H01M14/00",
         "H01L51/42",
         "H01L31/00",
         "E04D13/18",
         "H02S",
         "F03G6/00",
     ]},
    {"index": "3.3",
     "name": "风能",
     "no": [
         "F03D", "H02P101/15",
         "F04B17/02",
     ]},
    {"index": "3.4",
     "name": "海洋能",
     "no": [
         "F03B13/12", "E02B9/08",
         "F03G7/05",
     ]},
    {"index": "3.5",
     "name": "地热能",
     "no": [
         "F24J3/08", "F24T",
         "F03G4/00"
     ]},
    {"index": "3.6",
     "name": "氢能",
     "no": [
         "B01J27/24", "C12P3/00", "C25B1/00", "C25B9/00",
         "C25B15/00",
         "C01B3/00",
         "F17C",
         "B22F", "B82Y", "C01B6/00", "C22C",
         "F25B17/12",
         "B01J20/00", "C01B31/00", "C01B32/00",
         "C08G18/00", "C08G59/00", "C08G77/00", "C08K3/00",
         "C08K5/00", "C08L63/00", "C08L83/00", "C08L101/00",
         "H01M4/86", "H01M8/00", "H01M12/00",
         "F25J1/02",
     ]},
    {"index": "3.7",
     "name": "生物质能",
     "no": [
         "F24J3/08", "F24T",
         "F03G4/00",
         "C10G1/00(NOT:C10G1/10)", "C10L1/02",
         "C10L3/00(NOT:C10L3/02ORC10L3/04ORC10L3/06ORC10L3/10ORC10L3/12)",
         "C10L5/40",
         "C12P7/06",
         "C02F11/04", "C12M1/107",
         "C10B53/00", "C10J3/00",
     ]},
    {"index": "3.8",
     "name": "核能",
     "no": [
         "G21B", "G21C",
         "G21H", "G21J3/00",
         "G21D"
     ]},
    {"index": "4.1",
     "name": "机械储能",
     "no": [
         "F02C6/16",
         "H02J1/16", "H02J3/28", "H02J3/30", "H02J15/00",
         "H02K7/02", "F03D9/12", "F03G7/08", "F04B41/02",
         "B60K6/10", "B60K6/12", "B60K6/30", "B60L50/30",
     ]},
    {"index": "4.2",
     "name": "热储能",
     "no": [
         "F24H7/00", "F28D20/00",
         "C09K5/00", "F22B1/06",
     ]},
    {"index": "4.3",
     "name": "电化学储能",
     "no": [
         "H01M10/00", "H01M50/00", "H01M4/02(NOT:H01M4/06", "H01M4/86)",
         "H01G11/00",
         "B60K1/04", "B60K6/28", "B60L50/40", "B60L50/50",
         "B60L58/00", "B60R16/04", "B60W10/26",
     ]},
    {"index": "5.1",
     "name": "CO2的捕集利用封存",
     "no": [
         "B01D15/00", "B01D53/02", "B01J20/00",
         "B01D53/14",
         "F25J3/00",
         "B01D53/34(NOT:B01D53/84)",
         "B01D53/84",
         "B01D53/22", "B01D53/24", "B01D53/26", "B01D53/30",
         "B01D53/32", "C12M1/00",
         "C01B31/20", "C01B32/50",
         "B29", "C01B32/60", "C07C263/04", "C07C265/00",
         "C07C269/04", "C07C271/00", "C07C69/96", "C07D317/34",
         "C08", "C10B53/07", "C25B3/04", "C25B3/26",
         "C01B31/22", "C01B32/55", "C07C1/12", "C07C273/04",
         "C07C51/15", "C07C68/04",
         "B28B11/24", "C04",
         "C07C29/151", "C07C29/153", "C07C29/154",
         "C12C", "C12F3/00", "C12G3/00", "A23L",
         "A62C13/00",
         "F25B", "F25D3/12", "F25J1/00",
         "B65G5/00", "E21B41/00", "E21B43/00", "E21F15/08",
         "E21F17/16",
         "F17C1/00",
         "G01M", "G01N",
         "C01B31/20", "C01B32/50",
     ]},
    {"index": "5.2",
     "name": "其它温室气体减排",
     "no": [
         "B01D15/00", "B01D46/00", "B01D53/00", "B01J20/00",
         "G01N30/00",
         "B01D15/00", "B01D46/00", "B01D53/00", "B01J20/00",
         "G01N30/00",
         "B01D15/00", "B01D46/00", "B01D53/00", "B01J20/00",
         "G01N30/00",
     ]},
]

IPC_to_index = {}
category_number = len(IPC_info)
for i in range(category_number):
    category = IPC_info[i]
    for IPC_no in category["no"]:
        if IPC_no not in IPC_to_index:
            IPC_to_index[IPC_no] = []
        IPC_to_index[IPC_no].append(i)

IPC_category_list = ["{} {}".format(item["index"], item["name"]) for item in IPC_info]


def IPC_list_to_index_list(ipc_list):
    index_dict = {item: 0 for item in IPC_category_list}
    index_dict["unknown"] = 0
    cnt = 0
    for ipc_no in ipc_list:
        if ipc_no not in IPC_to_index:
            index_dict["unknown"] = 1
        else:
            cnt += 1
            for idx in IPC_to_index[ipc_no]:
                index_dict[IPC_category_list[idx]] = 1

    return index_dict, cnt


